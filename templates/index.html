<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì–´ë¦°ì´ ìƒ‰ì¹  ë†€ì´ ğŸ¨</title>
  <style>
    /* â”€â”€ ê¸°ë³¸ â”€â”€ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: "Segoe UI", Arial, sans-serif;
      background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 12px;
    }

    h1 {
      font-size: 2rem;
      font-weight: 800;
      color: #d44;
      text-shadow: 2px 2px 0 #fff, 3px 3px 0 #f88;
      margin: 8px 0 12px;
      letter-spacing: 1px;
    }

    /* â”€â”€ ë©”ì¸ ë ˆì´ì•„ì›ƒ â”€â”€ */
    #app {
      display: flex;
      gap: 16px;
      align-items: flex-start;
      width: 100%;
      max-width: 1440px;
      flex-wrap: wrap;
      justify-content: center;
    }

    /* â”€â”€ ë„êµ¬ íŒ¨ë„ â”€â”€ */
    #toolPanel {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 18px rgba(0,0,0,.12);
      padding: 14px 12px;
      display: flex;
      flex-direction: column;
      gap: 14px;
      min-width: 140px;
      flex-shrink: 0;
    }

    .panel-title {
      font-size: .72rem;
      font-weight: 700;
      color: #aaa;
      text-transform: uppercase;
      letter-spacing: .8px;
      text-align: center;
    }

    /* ë„êµ¬ ë²„íŠ¼ */
    .tool-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 6px;
    }

    .tool-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 3px;
      padding: 8px 4px;
      background: #f5f5f5;
      border: 2px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      font-size: .68rem;
      font-weight: 600;
      color: #555;
      transition: all .15s;
    }

    .tool-btn svg { width: 26px; height: 26px; }
    .tool-btn:hover   { background: #e8f4ff; border-color: #90c0ff; }
    .tool-btn.active  { background: #d0e8ff; border-color: #4a90e2; color: #2266bb; }

    /* ìƒ‰ìƒ íŒ”ë ˆíŠ¸ */
    #palette {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 5px;
    }

    .swatch {
      width: 26px;
      height: 26px;
      border-radius: 6px;
      border: 2px solid rgba(0,0,0,.15);
      cursor: pointer;
      transition: transform .1s, box-shadow .1s;
    }
    .swatch:hover { transform: scale(1.18); box-shadow: 0 2px 8px rgba(0,0,0,.25); }

    /* ìƒ‰ìƒ í”¼ì»¤ */
    .color-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    #colorPreview {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      border: 2px solid #ccc;
      flex-shrink: 0;
      background: #FF0000;
    }

    #colorPicker {
      flex: 1;
      height: 32px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      padding: 2px;
    }

    /* ìŠ¬ë¼ì´ë” */
    .slider-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .slider-label {
      display: flex;
      justify-content: space-between;
      font-size: .75rem;
      color: #666;
      font-weight: 600;
    }

    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: #ddd;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #4a90e2;
      cursor: pointer;
      box-shadow: 0 1px 4px rgba(0,0,0,.25);
    }

    /* ì•¡ì…˜ ë²„íŠ¼ */
    .btn-row {
      display: flex;
      gap: 6px;
    }

    .btn {
      flex: 1;
      padding: 8px 4px;
      border: none;
      border-radius: 10px;
      font-size: .75rem;
      font-weight: 700;
      cursor: pointer;
      transition: filter .15s, transform .1s;
    }
    .btn:hover  { filter: brightness(1.07); }
    .btn:active { transform: scale(.96); }
    .btn:disabled { opacity: .45; cursor: not-allowed; }

    .btn-undo   { background: #e0e0e0; color: #444; }
    .btn-redo   { background: #e0e0e0; color: #444; }
    .btn-clear  { background: #ffcccc; color: #c00; }
    .btn-save   {
      background: linear-gradient(135deg, #43c6ac, #191654);
      color: #fff;
      padding: 10px;
      font-size: .85rem;
      border-radius: 12px;
    }

    /* â”€â”€ ìº”ë²„ìŠ¤ ì˜ì—­ â”€â”€ */
    #canvasWrapper {
      position: relative;
      width: 512px;
      height: 512px;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 6px 24px rgba(0,0,0,.18);
      flex-shrink: 0;
    }

    #bgCanvas, #drawCanvas {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      display: block;
    }

    #bgCanvas  { z-index: 1; background: #fff; }
    #drawCanvas { z-index: 2; }

    /* â”€â”€ 3D ë·° â”€â”€ */
    #threeWrapper {
      flex: 1 1 480px;
      max-width: 720px;
      min-width: 320px;
      aspect-ratio: 1 / 1;
      position: relative;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 6px 24px rgba(0,0,0,.18);
    }

    #threeContainer {
      width: 100%;
      height: 100%;
      background: #111;
      display: block;
    }

    #threeLabel {
      position: absolute;
      top: 10px;
      left: 14px;
      color: rgba(255,255,255,.7);
      font-size: .8rem;
      font-weight: 700;
      pointer-events: none;
      z-index: 5;
    }

    #toggleAnimateBtn {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 10;
      padding: 6px 12px;
      font-size: .8rem;
      cursor: pointer;
      background: rgba(255,255,255,.85);
      border: 1px solid #888;
      border-radius: 8px;
      font-weight: 600;
    }

    /* â”€â”€ í† ìŠ¤íŠ¸ ì•Œë¦¼ â”€â”€ */
    #toast {
      position: fixed;
      bottom: 28px;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: #fff;
      padding: 12px 24px;
      border-radius: 24px;
      font-size: .9rem;
      font-weight: 600;
      opacity: 0;
      transition: opacity .3s;
      pointer-events: none;
      z-index: 9999;
      white-space: nowrap;
    }
    .toast-error { background: #c00 !important; }

    /* â”€â”€ êµ¬ë¶„ì„  â”€â”€ */
    .divider {
      border: none;
      border-top: 1px solid #eee;
    }

    /* â”€â”€ ë°˜ì‘í˜• â”€â”€ */
    @media (max-width: 680px) {
      h1 { font-size: 1.4rem; }
      #canvasWrapper { width: min(92vw, 512px); height: min(92vw, 512px); }
      #toolPanel { flex-direction: row; flex-wrap: wrap; min-width: unset; width: 100%; }
      .tool-grid { grid-template-columns: repeat(4, 1fr); }
      #palette { grid-template-columns: repeat(8, 1fr); }
    }
  </style>
</head>
<body>
  <h1>ğŸ¨ ì–´ë¦°ì´ ìƒ‰ì¹  ë†€ì´</h1>

  <div id="app">

    <!-- â”€â”€ ë„êµ¬ íŒ¨ë„ â”€â”€ -->
    <div id="toolPanel">

      <div class="panel-title">ë„êµ¬</div>
      <div class="tool-grid">
        <!-- ì—°í•„ -->
        <button class="tool-btn active" data-tool="pencil" title="ì—°í•„ (P)">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 20h9M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"/>
          </svg>
          ì—°í•„
        </button>
        <!-- ë²„í‚· ì±„ìš°ê¸° -->
        <button class="tool-btn" data-tool="fill" title="ì±„ìš°ê¸° (F)">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 11l-8-8-8.5 8.5a5.5 5.5 0 007.78 7.78L19 11z"/>
            <path d="M20 23a2 2 0 100-4c-1 0-2 1-2 2s1 2 2 2z"/>
          </svg>
          ì±„ìš°ê¸°
        </button>
        <!-- ì§€ìš°ê°œ -->
        <button class="tool-btn" data-tool="eraser" title="ì§€ìš°ê°œ (E)">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 20H7L3 16l11-11 7 7-1 8z"/>
            <path d="M6.5 17.5l5-5"/>
          </svg>
          ì§€ìš°ê°œ
        </button>
        <!-- ìŠ¤í¬ì´ë“œ -->
        <button class="tool-btn" data-tool="eyedropper" title="ìƒ‰ìƒ ì¶”ì¶œ (I)">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M2 22l4-4m0 0L15.5 8.5M6 18l9.5-9.5m0 0L18 6.5l-1-1-2.5 2.5m1.5-1.5l3-3a2.83 2.83 0 014 4l-3 3"/>
          </svg>
          ìŠ¤í¬ì´ë“œ
        </button>
      </div>

      <hr class="divider"/>

      <!-- íŒ”ë ˆíŠ¸ -->
      <div class="panel-title">ìƒ‰ìƒ íŒ”ë ˆíŠ¸</div>
      <div id="palette"></div>

      <!-- ìƒ‰ìƒ ì§ì ‘ ì„ íƒ -->
      <div class="color-row">
        <div id="colorPreview"></div>
        <input type="color" id="colorPicker" value="#FF0000" title="ìƒ‰ìƒ ì§ì ‘ ì„ íƒ" />
      </div>

      <hr class="divider"/>

      <!-- ë¸ŒëŸ¬ì‹œ í¬ê¸° -->
      <div class="slider-row">
        <div class="slider-label">
          <span>ë¸ŒëŸ¬ì‹œ í¬ê¸°</span>
          <span id="brushSizeLabel">15px</span>
        </div>
        <input type="range" id="brushSize" min="1" max="60" value="15" />
      </div>

      <!-- ë¶ˆíˆ¬ëª…ë„ -->
      <div class="slider-row">
        <div class="slider-label">
          <span>ë¶ˆíˆ¬ëª…ë„</span>
          <span id="opacityLabel">100%</span>
        </div>
        <input type="range" id="opacity" min="10" max="100" value="100" />
      </div>

      <hr class="divider"/>

      <!-- ì‹¤í–‰ì·¨ì†Œ / ë‹¤ì‹œì‹¤í–‰ -->
      <div class="btn-row">
        <button class="btn btn-undo" id="undoBtn" title="ì‹¤í–‰ ì·¨ì†Œ (Ctrl+Z)">â†© ë˜ëŒë¦¬ê¸°</button>
        <button class="btn btn-redo" id="redoBtn" title="ë‹¤ì‹œ ì‹¤í–‰ (Ctrl+Y)">â†ª ë‹¤ì‹œí•˜ê¸°</button>
      </div>

      <!-- ì „ì²´ ì§€ìš°ê¸° -->
      <button class="btn btn-clear" id="clearBtn">ğŸ—‘ ì „ì²´ ì§€ìš°ê¸°</button>

      <!-- ì €ì¥ -->
      <button class="btn btn-save" id="saveBtn">ğŸ’¾ ì €ì¥ &amp; 3D ë°˜ì˜</button>

    </div>
    <!-- /toolPanel -->

    <!-- â”€â”€ 2D ìº”ë²„ìŠ¤ â”€â”€ -->
    <div id="canvasWrapper">
      <canvas id="bgCanvas"></canvas>
      <canvas id="drawCanvas"></canvas>
    </div>

    <!-- â”€â”€ 3D ë·° â”€â”€ -->
    <div id="threeWrapper">
      <span id="threeLabel">3D ë¯¸ë¦¬ë³´ê¸°</span>
      <div id="threeContainer"></div>
      <button id="toggleAnimateBtn">ğŸ”„ íšŒì „ ON/OFF</button>
    </div>

  </div><!-- /app -->

  <!-- ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="{{ url_for('static', filename='js/konva.min.js') }}"></script>
  <script type="module" src="{{ url_for('static', filename='js/paint.js') }}"></script>
</body>
</html>
